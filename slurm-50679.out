/var/spool/slurmd/job50679/slurm_script: line 12: cd: SSL_VAN: No such file or directory

----------------------------------------------------------------------------
  cuda:
----------------------------------------------------------------------------
     Versions:
        cuda/10.2
        cuda/11.0
        cuda/11.2
        cuda/11.3
        cuda/11.4
        cuda/11.5
        cuda/11.6
        cuda/12.0

----------------------------------------------------------------------------
  For detailed information about a specific "cuda" package (including how to load the modules) use the module's full name.
  Note that names that have a trailing (E) are extensions provided by other modules.
  For example:

     $ module spider cuda/12.0
----------------------------------------------------------------------------

 


CommandNotFoundError: Your shell has not been properly configured to use 'conda activate'.
To initialize your shell, run

    $ conda init <SHELL_NAME>

Currently supported shells are:
  - bash
  - fish
  - tcsh
  - xonsh
  - zsh
  - powershell

See 'conda init --help' for more information and options.

IMPORTANT: You may need to close and restart your shell after running 'conda init'.


2023-04-27 22:21:06 | INFO | root | Namespace(a_min=-1000, a_max=1000, b_min=0.0, b_max=1.0, space_x=1.5, space_y=1.5, space_z=2.0, roi_x=96, roi_y=96, roi_z=96, num_workers=48, distributed=False, mode='server', num_samples=6, km_path='./cluster_models_1/cluster_model_1_{}_{}_{}.joblib', n_clusters=176, seed=42, init='k-means++', max_iter=250, batch_size=20, tol=0.0, max_no_improvement=100, n_init=50, reassignment_ratio=0.0)
Dataset 1 LUNA16: number of data: 842
Dataset 2 Covid 19: OK number of data: 722
Dataset 3 HNSCC: number of data: 1222
Dataset 4 TCIA Colon: number of data: 1535
Dataset 5 TCIA LIDC: number of data: 450
Dataset all training: number of data: 450
loader is ready
2023-04-27 22:22:27 | INFO | learn_kmeans | for batch number 0 the res size is 0
2023-04-27 22:22:27 | INFO | learn_kmeans | for batch number 1 the res size is 2304
2023-04-27 22:22:37 | INFO | learn_kmeans | for batch number 2 the res size is 3456
2023-04-27 22:22:37 | INFO | learn_kmeans | for batch number 3 the res size is 4608
2023-04-27 22:22:38 | INFO | learn_kmeans | for batch number 4 the res size is 5760
2023-04-27 22:22:48 | INFO | learn_kmeans | for batch number 5 the res size is 6912
2023-04-27 22:22:48 | INFO | learn_kmeans | for batch number 6 the res size is 8064
2023-04-27 22:22:48 | INFO | learn_kmeans | for batch number 7 the res size is 9216
2023-04-27 22:22:48 | INFO | learn_kmeans | for batch number 8 the res size is 10368
2023-04-27 22:22:48 | INFO | learn_kmeans | for batch number 9 the res size is 11520
2023-04-27 22:22:48 | INFO | learn_kmeans | for batch number 10 the res size is 12672
2023-04-27 22:22:48 | INFO | learn_kmeans | for batch number 11 the res size is 13824
2023-04-27 22:22:48 | INFO | learn_kmeans | for batch number 12 the res size is 14976
2023-04-27 22:22:48 | INFO | learn_kmeans | for batch number 13 the res size is 16128
2023-04-27 22:22:48 | INFO | learn_kmeans | for batch number 14 the res size is 17280
2023-04-27 22:22:48 | INFO | learn_kmeans | for batch number 15 the res size is 18432
2023-04-27 22:22:48 | INFO | learn_kmeans | for batch number 16 the res size is 19584
2023-04-27 22:22:48 | INFO | learn_kmeans | for batch number 17 the res size is 20736
2023-04-27 22:22:48 | INFO | learn_kmeans | for batch number 18 the res size is 21888
Traceback (most recent call last):
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 145, in <module>
    learn_kmeans(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 73, in learn_kmeans
    feat = load_data(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 50, in load_data
    for idx, batch_data in enumerate(training_loader):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1313, in _next_data
    return self._process_data(data)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 19.
Original Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/loadsave.py", line 87, in load
    stat_result = os.stat(filename)
FileNotFoundError: [Errno 2] No such file or directory: '/home/karimimonsefi.1/images/TCIA_LIDC/images/img_151_2.nii.gz'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/dictionary.py", line 131, in __call__
    data = self._loader(d[key], reader)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/array.py", line 213, in __call__
    img = reader.read(filename)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/image_reader.py", line 421, in read
    img = nib.load(name, **kwargs_)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/loadsave.py", line 89, in load
    raise FileNotFoundError(f"No such file or no access: '{filename}'")
FileNotFoundError: No such file or no access: '/home/karimimonsefi.1/images/TCIA_LIDC/images/img_151_2.nii.gz'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/compose.py", line 173, in __call__
    input_ = apply_transform(_transform, input_, self.map_items, self.unpack_items, self.log_stats)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.io.dictionary.LoadImaged object at 0x14b915cc3be0>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 97, in __getitem__
    return self._transform(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 83, in _transform
    return apply_transform(self.transform, data_i) if self.transform is not None else data_i
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.compose.Compose object at 0x14b801ee8e80>

2023-04-27 22:23:01 | INFO | root | Namespace(a_min=-1000, a_max=1000, b_min=0.0, b_max=1.0, space_x=1.5, space_y=1.5, space_z=2.0, roi_x=96, roi_y=96, roi_z=96, num_workers=48, distributed=False, mode='server', num_samples=6, km_path='./cluster_models_1/cluster_model_1_{}_{}_{}.joblib', n_clusters=403, seed=42, init='k-means++', max_iter=250, batch_size=20, tol=0.0, max_no_improvement=100, n_init=50, reassignment_ratio=0.0)
Dataset 1 LUNA16: number of data: 842
Dataset 2 Covid 19: OK number of data: 722
Dataset 3 HNSCC: number of data: 1222
Dataset 4 TCIA Colon: number of data: 1535
Dataset 5 TCIA LIDC: number of data: 450
Dataset all training: number of data: 450
loader is ready
2023-04-27 22:23:35 | INFO | learn_kmeans | for batch number 0 the res size is 0
2023-04-27 22:23:35 | INFO | learn_kmeans | for batch number 1 the res size is 2304
2023-04-27 22:23:35 | INFO | learn_kmeans | for batch number 2 the res size is 3456
2023-04-27 22:23:36 | INFO | learn_kmeans | for batch number 3 the res size is 4608
2023-04-27 22:23:36 | INFO | learn_kmeans | for batch number 4 the res size is 5760
2023-04-27 22:23:36 | INFO | learn_kmeans | for batch number 5 the res size is 6912
2023-04-27 22:23:36 | INFO | learn_kmeans | for batch number 6 the res size is 8064
2023-04-27 22:23:36 | INFO | learn_kmeans | for batch number 7 the res size is 9216
2023-04-27 22:23:36 | INFO | learn_kmeans | for batch number 8 the res size is 10368
2023-04-27 22:23:36 | INFO | learn_kmeans | for batch number 9 the res size is 11520
2023-04-27 22:23:36 | INFO | learn_kmeans | for batch number 10 the res size is 12672
2023-04-27 22:23:36 | INFO | learn_kmeans | for batch number 11 the res size is 13824
2023-04-27 22:23:36 | INFO | learn_kmeans | for batch number 12 the res size is 14976
2023-04-27 22:23:36 | INFO | learn_kmeans | for batch number 13 the res size is 16128
2023-04-27 22:23:36 | INFO | learn_kmeans | for batch number 14 the res size is 17280
2023-04-27 22:23:36 | INFO | learn_kmeans | for batch number 15 the res size is 18432
2023-04-27 22:23:36 | INFO | learn_kmeans | for batch number 16 the res size is 19584
2023-04-27 22:23:36 | INFO | learn_kmeans | for batch number 17 the res size is 20736
2023-04-27 22:23:36 | INFO | learn_kmeans | for batch number 18 the res size is 21888
Traceback (most recent call last):
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 145, in <module>
    learn_kmeans(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 73, in learn_kmeans
    feat = load_data(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 50, in load_data
    for idx, batch_data in enumerate(training_loader):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1313, in _next_data
    return self._process_data(data)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 19.
Original Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/loadsave.py", line 87, in load
    stat_result = os.stat(filename)
FileNotFoundError: [Errno 2] No such file or directory: '/home/karimimonsefi.1/images/TCIA_LIDC/images/img_151_2.nii.gz'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/dictionary.py", line 131, in __call__
    data = self._loader(d[key], reader)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/array.py", line 213, in __call__
    img = reader.read(filename)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/image_reader.py", line 421, in read
    img = nib.load(name, **kwargs_)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/loadsave.py", line 89, in load
    raise FileNotFoundError(f"No such file or no access: '{filename}'")
FileNotFoundError: No such file or no access: '/home/karimimonsefi.1/images/TCIA_LIDC/images/img_151_2.nii.gz'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/compose.py", line 173, in __call__
    input_ = apply_transform(_transform, input_, self.map_items, self.unpack_items, self.log_stats)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.io.dictionary.LoadImaged object at 0x154446722be0>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 97, in __getitem__
    return self._transform(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 83, in _transform
    return apply_transform(self.transform, data_i) if self.transform is not None else data_i
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.compose.Compose object at 0x154332946610>

2023-04-27 22:23:41 | INFO | root | Namespace(a_min=-1000, a_max=1000, b_min=0.0, b_max=1.0, space_x=1.5, space_y=1.5, space_z=2.0, roi_x=96, roi_y=96, roi_z=96, num_workers=48, distributed=False, mode='server', num_samples=6, km_path='./cluster_models_1/cluster_model_1_{}_{}_{}.joblib', n_clusters=235, seed=42, init='k-means++', max_iter=250, batch_size=20, tol=0.0, max_no_improvement=100, n_init=50, reassignment_ratio=0.0)
Dataset 1 LUNA16: number of data: 842
Dataset 2 Covid 19: OK number of data: 722
Dataset 3 HNSCC: number of data: 1222
Dataset 4 TCIA Colon: number of data: 1535
Dataset 5 TCIA LIDC: number of data: 450
Dataset all training: number of data: 450
loader is ready
2023-04-27 22:24:17 | INFO | learn_kmeans | for batch number 0 the res size is 0
2023-04-27 22:24:17 | INFO | learn_kmeans | for batch number 1 the res size is 2304
2023-04-27 22:24:17 | INFO | learn_kmeans | for batch number 2 the res size is 3456
2023-04-27 22:24:17 | INFO | learn_kmeans | for batch number 3 the res size is 4608
2023-04-27 22:24:17 | INFO | learn_kmeans | for batch number 4 the res size is 5760
2023-04-27 22:24:17 | INFO | learn_kmeans | for batch number 5 the res size is 6912
2023-04-27 22:24:17 | INFO | learn_kmeans | for batch number 6 the res size is 8064
2023-04-27 22:24:17 | INFO | learn_kmeans | for batch number 7 the res size is 9216
2023-04-27 22:24:17 | INFO | learn_kmeans | for batch number 8 the res size is 10368
2023-04-27 22:24:17 | INFO | learn_kmeans | for batch number 9 the res size is 11520
2023-04-27 22:24:17 | INFO | learn_kmeans | for batch number 10 the res size is 12672
2023-04-27 22:24:17 | INFO | learn_kmeans | for batch number 11 the res size is 13824
2023-04-27 22:24:17 | INFO | learn_kmeans | for batch number 12 the res size is 14976
2023-04-27 22:24:18 | INFO | learn_kmeans | for batch number 13 the res size is 16128
2023-04-27 22:24:18 | INFO | learn_kmeans | for batch number 14 the res size is 17280
2023-04-27 22:24:18 | INFO | learn_kmeans | for batch number 15 the res size is 18432
2023-04-27 22:24:18 | INFO | learn_kmeans | for batch number 16 the res size is 19584
2023-04-27 22:24:18 | INFO | learn_kmeans | for batch number 17 the res size is 20736
2023-04-27 22:24:18 | INFO | learn_kmeans | for batch number 18 the res size is 21888
Traceback (most recent call last):
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 145, in <module>
    learn_kmeans(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 73, in learn_kmeans
    feat = load_data(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 50, in load_data
    for idx, batch_data in enumerate(training_loader):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1313, in _next_data
    return self._process_data(data)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 19.
Original Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/loadsave.py", line 87, in load
    stat_result = os.stat(filename)
FileNotFoundError: [Errno 2] No such file or directory: '/home/karimimonsefi.1/images/TCIA_LIDC/images/img_151_2.nii.gz'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/dictionary.py", line 131, in __call__
    data = self._loader(d[key], reader)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/array.py", line 213, in __call__
    img = reader.read(filename)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/image_reader.py", line 421, in read
    img = nib.load(name, **kwargs_)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/loadsave.py", line 89, in load
    raise FileNotFoundError(f"No such file or no access: '{filename}'")
FileNotFoundError: No such file or no access: '/home/karimimonsefi.1/images/TCIA_LIDC/images/img_151_2.nii.gz'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/compose.py", line 173, in __call__
    input_ = apply_transform(_transform, input_, self.map_items, self.unpack_items, self.log_stats)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.io.dictionary.LoadImaged object at 0x15029eec7be0>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 97, in __getitem__
    return self._transform(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 83, in _transform
    return apply_transform(self.transform, data_i) if self.transform is not None else data_i
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.compose.Compose object at 0x15018b0ec580>

2023-04-27 22:24:23 | INFO | root | Namespace(a_min=-1000, a_max=1000, b_min=0.0, b_max=1.0, space_x=1.5, space_y=1.5, space_z=2.0, roi_x=96, roi_y=96, roi_z=96, num_workers=48, distributed=False, mode='server', num_samples=6, km_path='./cluster_models_1/cluster_model_1_{}_{}_{}.joblib', n_clusters=205, seed=42, init='k-means++', max_iter=250, batch_size=20, tol=0.0, max_no_improvement=100, n_init=50, reassignment_ratio=0.0)
Dataset 1 LUNA16: number of data: 842
Dataset 2 Covid 19: OK number of data: 722
Dataset 3 HNSCC: number of data: 1222
Dataset 4 TCIA Colon: number of data: 1535
Dataset 5 TCIA LIDC: number of data: 450
Dataset all training: number of data: 450
loader is ready
2023-04-27 22:24:56 | INFO | learn_kmeans | for batch number 0 the res size is 0
2023-04-27 22:24:56 | INFO | learn_kmeans | for batch number 1 the res size is 2304
2023-04-27 22:24:56 | INFO | learn_kmeans | for batch number 2 the res size is 3456
2023-04-27 22:24:56 | INFO | learn_kmeans | for batch number 3 the res size is 4608
2023-04-27 22:24:56 | INFO | learn_kmeans | for batch number 4 the res size is 5760
2023-04-27 22:24:58 | INFO | learn_kmeans | for batch number 5 the res size is 6912
2023-04-27 22:24:59 | INFO | learn_kmeans | for batch number 6 the res size is 8064
2023-04-27 22:24:59 | INFO | learn_kmeans | for batch number 7 the res size is 9216
2023-04-27 22:24:59 | INFO | learn_kmeans | for batch number 8 the res size is 10368
2023-04-27 22:24:59 | INFO | learn_kmeans | for batch number 9 the res size is 11520
2023-04-27 22:24:59 | INFO | learn_kmeans | for batch number 10 the res size is 12672
2023-04-27 22:24:59 | INFO | learn_kmeans | for batch number 11 the res size is 13824
2023-04-27 22:24:59 | INFO | learn_kmeans | for batch number 12 the res size is 14976
2023-04-27 22:24:59 | INFO | learn_kmeans | for batch number 13 the res size is 16128
2023-04-27 22:24:59 | INFO | learn_kmeans | for batch number 14 the res size is 17280
2023-04-27 22:24:59 | INFO | learn_kmeans | for batch number 15 the res size is 18432
2023-04-27 22:24:59 | INFO | learn_kmeans | for batch number 16 the res size is 19584
2023-04-27 22:24:59 | INFO | learn_kmeans | for batch number 17 the res size is 20736
2023-04-27 22:24:59 | INFO | learn_kmeans | for batch number 18 the res size is 21888
Traceback (most recent call last):
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 145, in <module>
    learn_kmeans(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 73, in learn_kmeans
    feat = load_data(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 50, in load_data
    for idx, batch_data in enumerate(training_loader):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1313, in _next_data
    return self._process_data(data)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 19.
Original Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/loadsave.py", line 87, in load
    stat_result = os.stat(filename)
FileNotFoundError: [Errno 2] No such file or directory: '/home/karimimonsefi.1/images/TCIA_LIDC/images/img_151_2.nii.gz'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/dictionary.py", line 131, in __call__
    data = self._loader(d[key], reader)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/array.py", line 213, in __call__
    img = reader.read(filename)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/image_reader.py", line 421, in read
    img = nib.load(name, **kwargs_)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/loadsave.py", line 89, in load
    raise FileNotFoundError(f"No such file or no access: '{filename}'")
FileNotFoundError: No such file or no access: '/home/karimimonsefi.1/images/TCIA_LIDC/images/img_151_2.nii.gz'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/compose.py", line 173, in __call__
    input_ = apply_transform(_transform, input_, self.map_items, self.unpack_items, self.log_stats)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.io.dictionary.LoadImaged object at 0x1469137c4be0>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 97, in __getitem__
    return self._transform(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 83, in _transform
    return apply_transform(self.transform, data_i) if self.transform is not None else data_i
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.compose.Compose object at 0x1467ff9e7610>

2023-04-27 22:25:04 | INFO | root | Namespace(a_min=-1000, a_max=1000, b_min=0.0, b_max=1.0, space_x=1.5, space_y=1.5, space_z=2.0, roi_x=96, roi_y=96, roi_z=96, num_workers=48, distributed=False, mode='server', num_samples=6, km_path='./cluster_models_1/cluster_model_1_{}_{}_{}.joblib', n_clusters=378, seed=42, init='k-means++', max_iter=250, batch_size=20, tol=0.0, max_no_improvement=100, n_init=50, reassignment_ratio=0.0)
Dataset 1 LUNA16: number of data: 842
Dataset 2 Covid 19: OK number of data: 722
Dataset 3 HNSCC: number of data: 1222
Dataset 4 TCIA Colon: number of data: 1535
Dataset 5 TCIA LIDC: number of data: 450
Dataset all training: number of data: 450
loader is ready
2023-04-27 22:25:37 | INFO | learn_kmeans | for batch number 0 the res size is 0
2023-04-27 22:25:37 | INFO | learn_kmeans | for batch number 1 the res size is 2304
2023-04-27 22:25:37 | INFO | learn_kmeans | for batch number 2 the res size is 3456
2023-04-27 22:25:37 | INFO | learn_kmeans | for batch number 3 the res size is 4608
2023-04-27 22:25:37 | INFO | learn_kmeans | for batch number 4 the res size is 5760
2023-04-27 22:25:40 | INFO | learn_kmeans | for batch number 5 the res size is 6912
2023-04-27 22:25:40 | INFO | learn_kmeans | for batch number 6 the res size is 8064
2023-04-27 22:25:40 | INFO | learn_kmeans | for batch number 7 the res size is 9216
2023-04-27 22:25:40 | INFO | learn_kmeans | for batch number 8 the res size is 10368
2023-04-27 22:25:40 | INFO | learn_kmeans | for batch number 9 the res size is 11520
2023-04-27 22:25:40 | INFO | learn_kmeans | for batch number 10 the res size is 12672
2023-04-27 22:25:40 | INFO | learn_kmeans | for batch number 11 the res size is 13824
2023-04-27 22:25:40 | INFO | learn_kmeans | for batch number 12 the res size is 14976
2023-04-27 22:25:40 | INFO | learn_kmeans | for batch number 13 the res size is 16128
2023-04-27 22:25:40 | INFO | learn_kmeans | for batch number 14 the res size is 17280
2023-04-27 22:25:40 | INFO | learn_kmeans | for batch number 15 the res size is 18432
2023-04-27 22:25:40 | INFO | learn_kmeans | for batch number 16 the res size is 19584
2023-04-27 22:25:40 | INFO | learn_kmeans | for batch number 17 the res size is 20736
2023-04-27 22:25:40 | INFO | learn_kmeans | for batch number 18 the res size is 21888
Traceback (most recent call last):
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 145, in <module>
    learn_kmeans(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 73, in learn_kmeans
    feat = load_data(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 50, in load_data
    for idx, batch_data in enumerate(training_loader):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1313, in _next_data
    return self._process_data(data)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 19.
Original Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/loadsave.py", line 87, in load
    stat_result = os.stat(filename)
FileNotFoundError: [Errno 2] No such file or directory: '/home/karimimonsefi.1/images/TCIA_LIDC/images/img_151_2.nii.gz'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/dictionary.py", line 131, in __call__
    data = self._loader(d[key], reader)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/array.py", line 213, in __call__
    img = reader.read(filename)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/image_reader.py", line 421, in read
    img = nib.load(name, **kwargs_)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/loadsave.py", line 89, in load
    raise FileNotFoundError(f"No such file or no access: '{filename}'")
FileNotFoundError: No such file or no access: '/home/karimimonsefi.1/images/TCIA_LIDC/images/img_151_2.nii.gz'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/compose.py", line 173, in __call__
    input_ = apply_transform(_transform, input_, self.map_items, self.unpack_items, self.log_stats)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.io.dictionary.LoadImaged object at 0x14c460050be0>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 97, in __getitem__
    return self._transform(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 83, in _transform
    return apply_transform(self.transform, data_i) if self.transform is not None else data_i
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.compose.Compose object at 0x14c34c275640>

2023-04-27 22:25:45 | INFO | root | Namespace(a_min=-1000, a_max=1000, b_min=0.0, b_max=1.0, space_x=1.5, space_y=1.5, space_z=2.0, roi_x=96, roi_y=96, roi_z=96, num_workers=48, distributed=False, mode='server', num_samples=6, km_path='./cluster_models_1/cluster_model_1_{}_{}_{}.joblib', n_clusters=265, seed=42, init='k-means++', max_iter=250, batch_size=20, tol=0.0, max_no_improvement=100, n_init=50, reassignment_ratio=0.0)
Dataset 1 LUNA16: number of data: 842
Dataset 2 Covid 19: OK number of data: 722
Dataset 3 HNSCC: number of data: 1222
Dataset 4 TCIA Colon: number of data: 1535
Dataset 5 TCIA LIDC: number of data: 450
Dataset all training: number of data: 450
loader is ready
2023-04-27 22:26:19 | INFO | learn_kmeans | for batch number 0 the res size is 0
2023-04-27 22:26:19 | INFO | learn_kmeans | for batch number 1 the res size is 2304
2023-04-27 22:26:19 | INFO | learn_kmeans | for batch number 2 the res size is 3456
2023-04-27 22:26:19 | INFO | learn_kmeans | for batch number 3 the res size is 4608
2023-04-27 22:26:19 | INFO | learn_kmeans | for batch number 4 the res size is 5760
2023-04-27 22:26:19 | INFO | learn_kmeans | for batch number 5 the res size is 6912
2023-04-27 22:26:19 | INFO | learn_kmeans | for batch number 6 the res size is 8064
2023-04-27 22:26:19 | INFO | learn_kmeans | for batch number 7 the res size is 9216
2023-04-27 22:26:19 | INFO | learn_kmeans | for batch number 8 the res size is 10368
2023-04-27 22:26:19 | INFO | learn_kmeans | for batch number 9 the res size is 11520
2023-04-27 22:26:19 | INFO | learn_kmeans | for batch number 10 the res size is 12672
2023-04-27 22:26:19 | INFO | learn_kmeans | for batch number 11 the res size is 13824
2023-04-27 22:26:19 | INFO | learn_kmeans | for batch number 12 the res size is 14976
2023-04-27 22:26:19 | INFO | learn_kmeans | for batch number 13 the res size is 16128
2023-04-27 22:26:19 | INFO | learn_kmeans | for batch number 14 the res size is 17280
2023-04-27 22:26:19 | INFO | learn_kmeans | for batch number 15 the res size is 18432
2023-04-27 22:26:19 | INFO | learn_kmeans | for batch number 16 the res size is 19584
2023-04-27 22:26:19 | INFO | learn_kmeans | for batch number 17 the res size is 20736
2023-04-27 22:26:19 | INFO | learn_kmeans | for batch number 18 the res size is 21888
Traceback (most recent call last):
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 145, in <module>
    learn_kmeans(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 73, in learn_kmeans
    feat = load_data(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 50, in load_data
    for idx, batch_data in enumerate(training_loader):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1313, in _next_data
    return self._process_data(data)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 19.
Original Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/loadsave.py", line 87, in load
    stat_result = os.stat(filename)
FileNotFoundError: [Errno 2] No such file or directory: '/home/karimimonsefi.1/images/TCIA_LIDC/images/img_151_2.nii.gz'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/dictionary.py", line 131, in __call__
    data = self._loader(d[key], reader)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/array.py", line 213, in __call__
    img = reader.read(filename)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/image_reader.py", line 421, in read
    img = nib.load(name, **kwargs_)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/loadsave.py", line 89, in load
    raise FileNotFoundError(f"No such file or no access: '{filename}'")
FileNotFoundError: No such file or no access: '/home/karimimonsefi.1/images/TCIA_LIDC/images/img_151_2.nii.gz'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/compose.py", line 173, in __call__
    input_ = apply_transform(_transform, input_, self.map_items, self.unpack_items, self.log_stats)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.io.dictionary.LoadImaged object at 0x14dc8dbfebe0>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 97, in __getitem__
    return self._transform(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 83, in _transform
    return apply_transform(self.transform, data_i) if self.transform is not None else data_i
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.compose.Compose object at 0x14db79e23640>

2023-04-27 22:26:25 | INFO | root | Namespace(a_min=-1000, a_max=1000, b_min=0.0, b_max=1.0, space_x=1.5, space_y=1.5, space_z=2.0, roi_x=96, roi_y=96, roi_z=96, num_workers=48, distributed=False, mode='server', num_samples=6, km_path='./cluster_models_1/cluster_model_1_{}_{}_{}.joblib', n_clusters=69, seed=42, init='k-means++', max_iter=250, batch_size=20, tol=0.0, max_no_improvement=100, n_init=50, reassignment_ratio=0.0)
Dataset 1 LUNA16: number of data: 842
Dataset 2 Covid 19: OK number of data: 722
Dataset 3 HNSCC: number of data: 1222
Dataset 4 TCIA Colon: number of data: 1535
Dataset 5 TCIA LIDC: number of data: 450
Dataset all training: number of data: 450
loader is ready
2023-04-27 22:27:02 | INFO | learn_kmeans | for batch number 0 the res size is 0
2023-04-27 22:27:02 | INFO | learn_kmeans | for batch number 1 the res size is 2304
2023-04-27 22:27:02 | INFO | learn_kmeans | for batch number 2 the res size is 3456
2023-04-27 22:27:02 | INFO | learn_kmeans | for batch number 3 the res size is 4608
2023-04-27 22:27:02 | INFO | learn_kmeans | for batch number 4 the res size is 5760
2023-04-27 22:27:02 | INFO | learn_kmeans | for batch number 5 the res size is 6912
2023-04-27 22:27:02 | INFO | learn_kmeans | for batch number 6 the res size is 8064
2023-04-27 22:27:02 | INFO | learn_kmeans | for batch number 7 the res size is 9216
2023-04-27 22:27:02 | INFO | learn_kmeans | for batch number 8 the res size is 10368
2023-04-27 22:27:02 | INFO | learn_kmeans | for batch number 9 the res size is 11520
2023-04-27 22:27:02 | INFO | learn_kmeans | for batch number 10 the res size is 12672
2023-04-27 22:27:02 | INFO | learn_kmeans | for batch number 11 the res size is 13824
2023-04-27 22:27:02 | INFO | learn_kmeans | for batch number 12 the res size is 14976
2023-04-27 22:27:02 | INFO | learn_kmeans | for batch number 13 the res size is 16128
2023-04-27 22:27:02 | INFO | learn_kmeans | for batch number 14 the res size is 17280
2023-04-27 22:27:02 | INFO | learn_kmeans | for batch number 15 the res size is 18432
2023-04-27 22:27:02 | INFO | learn_kmeans | for batch number 16 the res size is 19584
2023-04-27 22:27:02 | INFO | learn_kmeans | for batch number 17 the res size is 20736
2023-04-27 22:27:02 | INFO | learn_kmeans | for batch number 18 the res size is 21888
Traceback (most recent call last):
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 145, in <module>
    learn_kmeans(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 73, in learn_kmeans
    feat = load_data(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 50, in load_data
    for idx, batch_data in enumerate(training_loader):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1313, in _next_data
    return self._process_data(data)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 19.
Original Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/loadsave.py", line 87, in load
    stat_result = os.stat(filename)
FileNotFoundError: [Errno 2] No such file or directory: '/home/karimimonsefi.1/images/TCIA_LIDC/images/img_151_2.nii.gz'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/dictionary.py", line 131, in __call__
    data = self._loader(d[key], reader)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/array.py", line 213, in __call__
    img = reader.read(filename)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/image_reader.py", line 421, in read
    img = nib.load(name, **kwargs_)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/loadsave.py", line 89, in load
    raise FileNotFoundError(f"No such file or no access: '{filename}'")
FileNotFoundError: No such file or no access: '/home/karimimonsefi.1/images/TCIA_LIDC/images/img_151_2.nii.gz'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/compose.py", line 173, in __call__
    input_ = apply_transform(_transform, input_, self.map_items, self.unpack_items, self.log_stats)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.io.dictionary.LoadImaged object at 0x14e321d4fbe0>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 97, in __getitem__
    return self._transform(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 83, in _transform
    return apply_transform(self.transform, data_i) if self.transform is not None else data_i
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.compose.Compose object at 0x14e20df74610>

2023-04-27 22:27:07 | INFO | root | Namespace(a_min=-1000, a_max=1000, b_min=0.0, b_max=1.0, space_x=1.5, space_y=1.5, space_z=2.0, roi_x=96, roi_y=96, roi_z=96, num_workers=48, distributed=False, mode='server', num_samples=6, km_path='./cluster_models_1/cluster_model_1_{}_{}_{}.joblib', n_clusters=221, seed=42, init='k-means++', max_iter=250, batch_size=20, tol=0.0, max_no_improvement=100, n_init=50, reassignment_ratio=0.0)
Dataset 1 LUNA16: number of data: 842
Dataset 2 Covid 19: OK number of data: 722
Dataset 3 HNSCC: number of data: 1222
Dataset 4 TCIA Colon: number of data: 1535
Dataset 5 TCIA LIDC: number of data: 450
Dataset all training: number of data: 450
loader is ready
2023-04-27 22:27:40 | INFO | learn_kmeans | for batch number 0 the res size is 0
2023-04-27 22:27:41 | INFO | learn_kmeans | for batch number 1 the res size is 2304
2023-04-27 22:27:41 | INFO | learn_kmeans | for batch number 2 the res size is 3456
2023-04-27 22:27:41 | INFO | learn_kmeans | for batch number 3 the res size is 4608
2023-04-27 22:27:41 | INFO | learn_kmeans | for batch number 4 the res size is 5760
2023-04-27 22:27:41 | INFO | learn_kmeans | for batch number 5 the res size is 6912
2023-04-27 22:27:41 | INFO | learn_kmeans | for batch number 6 the res size is 8064
2023-04-27 22:27:41 | INFO | learn_kmeans | for batch number 7 the res size is 9216
2023-04-27 22:27:41 | INFO | learn_kmeans | for batch number 8 the res size is 10368
2023-04-27 22:27:41 | INFO | learn_kmeans | for batch number 9 the res size is 11520
2023-04-27 22:27:41 | INFO | learn_kmeans | for batch number 10 the res size is 12672
2023-04-27 22:27:41 | INFO | learn_kmeans | for batch number 11 the res size is 13824
2023-04-27 22:27:41 | INFO | learn_kmeans | for batch number 12 the res size is 14976
2023-04-27 22:27:41 | INFO | learn_kmeans | for batch number 13 the res size is 16128
2023-04-27 22:27:41 | INFO | learn_kmeans | for batch number 14 the res size is 17280
2023-04-27 22:27:41 | INFO | learn_kmeans | for batch number 15 the res size is 18432
2023-04-27 22:27:41 | INFO | learn_kmeans | for batch number 16 the res size is 19584
2023-04-27 22:27:41 | INFO | learn_kmeans | for batch number 17 the res size is 20736
2023-04-27 22:27:41 | INFO | learn_kmeans | for batch number 18 the res size is 21888
Traceback (most recent call last):
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 145, in <module>
    learn_kmeans(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 73, in learn_kmeans
    feat = load_data(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 50, in load_data
    for idx, batch_data in enumerate(training_loader):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1313, in _next_data
    return self._process_data(data)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 19.
Original Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/loadsave.py", line 87, in load
    stat_result = os.stat(filename)
FileNotFoundError: [Errno 2] No such file or directory: '/home/karimimonsefi.1/images/TCIA_LIDC/images/img_151_2.nii.gz'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/dictionary.py", line 131, in __call__
    data = self._loader(d[key], reader)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/array.py", line 213, in __call__
    img = reader.read(filename)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/image_reader.py", line 421, in read
    img = nib.load(name, **kwargs_)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/loadsave.py", line 89, in load
    raise FileNotFoundError(f"No such file or no access: '{filename}'")
FileNotFoundError: No such file or no access: '/home/karimimonsefi.1/images/TCIA_LIDC/images/img_151_2.nii.gz'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/compose.py", line 173, in __call__
    input_ = apply_transform(_transform, input_, self.map_items, self.unpack_items, self.log_stats)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.io.dictionary.LoadImaged object at 0x146c4df83be0>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 97, in __getitem__
    return self._transform(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 83, in _transform
    return apply_transform(self.transform, data_i) if self.transform is not None else data_i
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.compose.Compose object at 0x146b3a1a8580>

2023-04-27 22:27:46 | INFO | root | Namespace(a_min=-1000, a_max=1000, b_min=0.0, b_max=1.0, space_x=1.5, space_y=1.5, space_z=2.0, roi_x=96, roi_y=96, roi_z=96, num_workers=48, distributed=False, mode='server', num_samples=6, km_path='./cluster_models_1/cluster_model_1_{}_{}_{}.joblib', n_clusters=131, seed=42, init='k-means++', max_iter=250, batch_size=20, tol=0.0, max_no_improvement=100, n_init=50, reassignment_ratio=0.0)
Dataset 1 LUNA16: number of data: 842
Dataset 2 Covid 19: OK number of data: 722
Dataset 3 HNSCC: number of data: 1222
Dataset 4 TCIA Colon: number of data: 1535
Dataset 5 TCIA LIDC: number of data: 450
Dataset all training: number of data: 450
loader is ready
2023-04-27 22:28:19 | INFO | learn_kmeans | for batch number 0 the res size is 0
2023-04-27 22:28:19 | INFO | learn_kmeans | for batch number 1 the res size is 2304
2023-04-27 22:28:19 | INFO | learn_kmeans | for batch number 2 the res size is 3456
2023-04-27 22:28:19 | INFO | learn_kmeans | for batch number 3 the res size is 4608
2023-04-27 22:28:19 | INFO | learn_kmeans | for batch number 4 the res size is 5760
2023-04-27 22:28:21 | INFO | learn_kmeans | for batch number 5 the res size is 6912
2023-04-27 22:28:21 | INFO | learn_kmeans | for batch number 6 the res size is 8064
2023-04-27 22:28:21 | INFO | learn_kmeans | for batch number 7 the res size is 9216
2023-04-27 22:28:21 | INFO | learn_kmeans | for batch number 8 the res size is 10368
2023-04-27 22:28:21 | INFO | learn_kmeans | for batch number 9 the res size is 11520
2023-04-27 22:28:21 | INFO | learn_kmeans | for batch number 10 the res size is 12672
2023-04-27 22:28:21 | INFO | learn_kmeans | for batch number 11 the res size is 13824
2023-04-27 22:28:21 | INFO | learn_kmeans | for batch number 12 the res size is 14976
2023-04-27 22:28:21 | INFO | learn_kmeans | for batch number 13 the res size is 16128
2023-04-27 22:28:21 | INFO | learn_kmeans | for batch number 14 the res size is 17280
2023-04-27 22:28:21 | INFO | learn_kmeans | for batch number 15 the res size is 18432
2023-04-27 22:28:21 | INFO | learn_kmeans | for batch number 16 the res size is 19584
2023-04-27 22:28:21 | INFO | learn_kmeans | for batch number 17 the res size is 20736
2023-04-27 22:28:21 | INFO | learn_kmeans | for batch number 18 the res size is 21888
Traceback (most recent call last):
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 145, in <module>
    learn_kmeans(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 73, in learn_kmeans
    feat = load_data(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 50, in load_data
    for idx, batch_data in enumerate(training_loader):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1313, in _next_data
    return self._process_data(data)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 19.
Original Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/loadsave.py", line 87, in load
    stat_result = os.stat(filename)
FileNotFoundError: [Errno 2] No such file or directory: '/home/karimimonsefi.1/images/TCIA_LIDC/images/img_151_2.nii.gz'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/dictionary.py", line 131, in __call__
    data = self._loader(d[key], reader)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/array.py", line 213, in __call__
    img = reader.read(filename)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/image_reader.py", line 421, in read
    img = nib.load(name, **kwargs_)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/loadsave.py", line 89, in load
    raise FileNotFoundError(f"No such file or no access: '{filename}'")
FileNotFoundError: No such file or no access: '/home/karimimonsefi.1/images/TCIA_LIDC/images/img_151_2.nii.gz'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/compose.py", line 173, in __call__
    input_ = apply_transform(_transform, input_, self.map_items, self.unpack_items, self.log_stats)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.io.dictionary.LoadImaged object at 0x14da90f4ebe0>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 97, in __getitem__
    return self._transform(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 83, in _transform
    return apply_transform(self.transform, data_i) if self.transform is not None else data_i
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.compose.Compose object at 0x14d97d173640>

2023-04-27 22:28:26 | INFO | root | Namespace(a_min=-1000, a_max=1000, b_min=0.0, b_max=1.0, space_x=1.5, space_y=1.5, space_z=2.0, roi_x=96, roi_y=96, roi_z=96, num_workers=48, distributed=False, mode='server', num_samples=6, km_path='./cluster_models_1/cluster_model_1_{}_{}_{}.joblib', n_clusters=199, seed=42, init='k-means++', max_iter=250, batch_size=20, tol=0.0, max_no_improvement=100, n_init=50, reassignment_ratio=0.0)
Dataset 1 LUNA16: number of data: 842
Dataset 2 Covid 19: OK number of data: 722
Dataset 3 HNSCC: number of data: 1222
Dataset 4 TCIA Colon: number of data: 1535
Dataset 5 TCIA LIDC: number of data: 450
Dataset all training: number of data: 450
loader is ready
2023-04-27 22:28:59 | INFO | learn_kmeans | for batch number 0 the res size is 0
2023-04-27 22:28:59 | INFO | learn_kmeans | for batch number 1 the res size is 2304
2023-04-27 22:28:59 | INFO | learn_kmeans | for batch number 2 the res size is 3456
2023-04-27 22:28:59 | INFO | learn_kmeans | for batch number 3 the res size is 4608
2023-04-27 22:28:59 | INFO | learn_kmeans | for batch number 4 the res size is 5760
2023-04-27 22:28:59 | INFO | learn_kmeans | for batch number 5 the res size is 6912
2023-04-27 22:28:59 | INFO | learn_kmeans | for batch number 6 the res size is 8064
2023-04-27 22:28:59 | INFO | learn_kmeans | for batch number 7 the res size is 9216
2023-04-27 22:28:59 | INFO | learn_kmeans | for batch number 8 the res size is 10368
2023-04-27 22:28:59 | INFO | learn_kmeans | for batch number 9 the res size is 11520
2023-04-27 22:28:59 | INFO | learn_kmeans | for batch number 10 the res size is 12672
2023-04-27 22:29:00 | INFO | learn_kmeans | for batch number 11 the res size is 13824
2023-04-27 22:29:00 | INFO | learn_kmeans | for batch number 12 the res size is 14976
2023-04-27 22:29:00 | INFO | learn_kmeans | for batch number 13 the res size is 16128
2023-04-27 22:29:00 | INFO | learn_kmeans | for batch number 14 the res size is 17280
2023-04-27 22:29:00 | INFO | learn_kmeans | for batch number 15 the res size is 18432
2023-04-27 22:29:00 | INFO | learn_kmeans | for batch number 16 the res size is 19584
2023-04-27 22:29:00 | INFO | learn_kmeans | for batch number 17 the res size is 20736
2023-04-27 22:29:00 | INFO | learn_kmeans | for batch number 18 the res size is 21888
Traceback (most recent call last):
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 145, in <module>
    learn_kmeans(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 73, in learn_kmeans
    feat = load_data(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 50, in load_data
    for idx, batch_data in enumerate(training_loader):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1313, in _next_data
    return self._process_data(data)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 19.
Original Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/loadsave.py", line 87, in load
    stat_result = os.stat(filename)
FileNotFoundError: [Errno 2] No such file or directory: '/home/karimimonsefi.1/images/TCIA_LIDC/images/img_151_2.nii.gz'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/dictionary.py", line 131, in __call__
    data = self._loader(d[key], reader)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/array.py", line 213, in __call__
    img = reader.read(filename)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/image_reader.py", line 421, in read
    img = nib.load(name, **kwargs_)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/loadsave.py", line 89, in load
    raise FileNotFoundError(f"No such file or no access: '{filename}'")
FileNotFoundError: No such file or no access: '/home/karimimonsefi.1/images/TCIA_LIDC/images/img_151_2.nii.gz'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/compose.py", line 173, in __call__
    input_ = apply_transform(_transform, input_, self.map_items, self.unpack_items, self.log_stats)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.io.dictionary.LoadImaged object at 0x15266d1b3be0>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 97, in __getitem__
    return self._transform(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 83, in _transform
    return apply_transform(self.transform, data_i) if self.transform is not None else data_i
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.compose.Compose object at 0x1525593d7e80>

2023-04-27 22:29:05 | INFO | root | Namespace(a_min=-1000, a_max=1000, b_min=0.0, b_max=1.0, space_x=1.5, space_y=1.5, space_z=2.0, roi_x=96, roi_y=96, roi_z=96, num_workers=48, distributed=False, mode='server', num_samples=6, km_path='./cluster_models_1/cluster_model_1_{}_{}_{}.joblib', n_clusters=282, seed=42, init='k-means++', max_iter=250, batch_size=20, tol=0.0, max_no_improvement=100, n_init=50, reassignment_ratio=0.0)
Dataset 1 LUNA16: number of data: 842
Dataset 2 Covid 19: OK number of data: 722
Dataset 3 HNSCC: number of data: 1222
Dataset 4 TCIA Colon: number of data: 1535
Dataset 5 TCIA LIDC: number of data: 450
Dataset all training: number of data: 450
loader is ready
slurmstepd: error: *** JOB 50679 ON a100-02 CANCELLED AT 2023-04-27T22:29:09 ***
