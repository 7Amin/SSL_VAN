/var/spool/slurmd/job45968/slurm_script: line 12: cd: SSL_VAN: No such file or directory

----------------------------------------------------------------------------
  cuda:
----------------------------------------------------------------------------
     Versions:
        cuda/10.2
        cuda/11.0
        cuda/11.2
        cuda/11.3
        cuda/11.4
        cuda/11.5
        cuda/11.6
        cuda/12.0

----------------------------------------------------------------------------
  For detailed information about a specific "cuda" package (including how to load the modules) use the module's full name.
  Note that names that have a trailing (E) are extensions provided by other modules.
  For example:

     $ module spider cuda/12.0
----------------------------------------------------------------------------

 


CommandNotFoundError: Your shell has not been properly configured to use 'conda activate'.
To initialize your shell, run

    $ conda init <SHELL_NAME>

Currently supported shells are:
  - bash
  - fish
  - tcsh
  - xonsh
  - zsh
  - powershell

See 'conda init --help' for more information and options.

IMPORTANT: You may need to close and restart your shell after running 'conda init'.


2023-04-23 20:36:02 | INFO | root | Namespace(a_min=-1000, a_max=1000, b_min=0.0, b_max=1.0, space_x=1.5, space_y=1.5, space_z=2.0, roi_x=96, roi_y=96, roi_z=96, num_workers=8, distributed=False, mode='server', num_samples=6, km_path='./cluster_models_1/cluster_model_1_{}_{}_{}.joblib', n_clusters=195, seed=42, init='k-means++', max_iter=250, batch_size=20, tol=0.0, max_no_improvement=100, n_init=50, reassignment_ratio=0.0)
Dataset 1 LUNA16: number of data: 842
Dataset 2 Covid 19: number of data: 722
Dataset 3 HNSCC: number of data: 1222
Dataset 4 TCIA Colon: number of data: 1535
Dataset 5: number of data: 450
Dataset all training: number of data: 4771
Traceback (most recent call last):
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 140, in <module>
    learn_kmeans(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 71, in learn_kmeans
    feat = load_data(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 50, in load_data
    for idx, batch_data in enumerate(training_loader):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1313, in _next_data
    return self._process_data(data)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 5.
Original Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/dictionary.py", line 131, in __call__
    data = self._loader(d[key], reader)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/array.py", line 240, in __call__
    img_array, meta_data = reader.get_data(img)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/image_reader.py", line 450, in get_data
    data = self._get_array_data(i)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/image_reader.py", line 522, in _get_array_data
    _array = np.array(img.get_fdata(dtype=self.dtype))
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/dataobj_images.py", line 368, in get_fdata
    data = np.asanyarray(self._dataobj, dtype=dtype)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/arrayproxy.py", line 426, in __array__
    arr = self._get_scaled(dtype=dtype, slicer=())
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/arrayproxy.py", line 393, in _get_scaled
    scaled = apply_read_scaling(self._get_unscaled(slicer=slicer), scl_slope, scl_inter)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/arrayproxy.py", line 363, in _get_unscaled
    return array_from_file(
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/volumeutils.py", line 454, in array_from_file
    n_read = infile.readinto(data_bytes)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/gzip.py", line 300, in read
    return self._buffer.read(size)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/_compression.py", line 68, in readinto
    data = self.read(len(byte_view))
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/gzip.py", line 506, in read
    raise EOFError("Compressed file ended before the "
EOFError: Compressed file ended before the end-of-stream marker was reached

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/compose.py", line 173, in __call__
    input_ = apply_transform(_transform, input_, self.map_items, self.unpack_items, self.log_stats)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.io.dictionary.LoadImaged object at 0x14d16cc18a00>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 97, in __getitem__
    return self._transform(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 83, in _transform
    return apply_transform(self.transform, data_i) if self.transform is not None else data_i
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.compose.Compose object at 0x14d058e91910>

2023-04-23 20:42:50 | INFO | root | Namespace(a_min=-1000, a_max=1000, b_min=0.0, b_max=1.0, space_x=1.5, space_y=1.5, space_z=2.0, roi_x=96, roi_y=96, roi_z=96, num_workers=8, distributed=False, mode='server', num_samples=6, km_path='./cluster_models_1/cluster_model_1_{}_{}_{}.joblib', n_clusters=52, seed=42, init='k-means++', max_iter=250, batch_size=20, tol=0.0, max_no_improvement=100, n_init=50, reassignment_ratio=0.0)
Dataset 1 LUNA16: number of data: 842
Dataset 2 Covid 19: number of data: 722
Dataset 3 HNSCC: number of data: 1222
Dataset 4 TCIA Colon: number of data: 1535
Dataset 5: number of data: 450
Dataset all training: number of data: 4771
Traceback (most recent call last):
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 140, in <module>
    learn_kmeans(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 71, in learn_kmeans
    feat = load_data(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 50, in load_data
    for idx, batch_data in enumerate(training_loader):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1313, in _next_data
    return self._process_data(data)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 5.
Original Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/dictionary.py", line 131, in __call__
    data = self._loader(d[key], reader)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/array.py", line 240, in __call__
    img_array, meta_data = reader.get_data(img)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/image_reader.py", line 450, in get_data
    data = self._get_array_data(i)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/image_reader.py", line 522, in _get_array_data
    _array = np.array(img.get_fdata(dtype=self.dtype))
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/dataobj_images.py", line 368, in get_fdata
    data = np.asanyarray(self._dataobj, dtype=dtype)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/arrayproxy.py", line 426, in __array__
    arr = self._get_scaled(dtype=dtype, slicer=())
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/arrayproxy.py", line 393, in _get_scaled
    scaled = apply_read_scaling(self._get_unscaled(slicer=slicer), scl_slope, scl_inter)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/arrayproxy.py", line 363, in _get_unscaled
    return array_from_file(
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/volumeutils.py", line 454, in array_from_file
    n_read = infile.readinto(data_bytes)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/gzip.py", line 300, in read
    return self._buffer.read(size)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/_compression.py", line 68, in readinto
    data = self.read(len(byte_view))
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/gzip.py", line 506, in read
    raise EOFError("Compressed file ended before the "
EOFError: Compressed file ended before the end-of-stream marker was reached

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/compose.py", line 173, in __call__
    input_ = apply_transform(_transform, input_, self.map_items, self.unpack_items, self.log_stats)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.io.dictionary.LoadImaged object at 0x152a0c740a00>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 97, in __getitem__
    return self._transform(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 83, in _transform
    return apply_transform(self.transform, data_i) if self.transform is not None else data_i
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.compose.Compose object at 0x1528f89b8910>

2023-04-23 20:44:58 | INFO | root | Namespace(a_min=-1000, a_max=1000, b_min=0.0, b_max=1.0, space_x=1.5, space_y=1.5, space_z=2.0, roi_x=96, roi_y=96, roi_z=96, num_workers=8, distributed=False, mode='server', num_samples=6, km_path='./cluster_models_1/cluster_model_1_{}_{}_{}.joblib', n_clusters=463, seed=42, init='k-means++', max_iter=250, batch_size=20, tol=0.0, max_no_improvement=100, n_init=50, reassignment_ratio=0.0)
Dataset 1 LUNA16: number of data: 842
Dataset 2 Covid 19: number of data: 722
Dataset 3 HNSCC: number of data: 1222
Dataset 4 TCIA Colon: number of data: 1535
Dataset 5: number of data: 450
Dataset all training: number of data: 4771
Traceback (most recent call last):
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 140, in <module>
    learn_kmeans(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 71, in learn_kmeans
    feat = load_data(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 50, in load_data
    for idx, batch_data in enumerate(training_loader):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1313, in _next_data
    return self._process_data(data)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 5.
Original Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/dictionary.py", line 131, in __call__
    data = self._loader(d[key], reader)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/array.py", line 240, in __call__
    img_array, meta_data = reader.get_data(img)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/image_reader.py", line 450, in get_data
    data = self._get_array_data(i)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/image_reader.py", line 522, in _get_array_data
    _array = np.array(img.get_fdata(dtype=self.dtype))
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/dataobj_images.py", line 368, in get_fdata
    data = np.asanyarray(self._dataobj, dtype=dtype)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/arrayproxy.py", line 426, in __array__
    arr = self._get_scaled(dtype=dtype, slicer=())
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/arrayproxy.py", line 393, in _get_scaled
    scaled = apply_read_scaling(self._get_unscaled(slicer=slicer), scl_slope, scl_inter)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/arrayproxy.py", line 363, in _get_unscaled
    return array_from_file(
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/volumeutils.py", line 454, in array_from_file
    n_read = infile.readinto(data_bytes)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/gzip.py", line 300, in read
    return self._buffer.read(size)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/_compression.py", line 68, in readinto
    data = self.read(len(byte_view))
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/gzip.py", line 506, in read
    raise EOFError("Compressed file ended before the "
EOFError: Compressed file ended before the end-of-stream marker was reached

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/compose.py", line 173, in __call__
    input_ = apply_transform(_transform, input_, self.map_items, self.unpack_items, self.log_stats)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.io.dictionary.LoadImaged object at 0x148526638a00>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 97, in __getitem__
    return self._transform(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 83, in _transform
    return apply_transform(self.transform, data_i) if self.transform is not None else data_i
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.compose.Compose object at 0x14841285ec40>

2023-04-23 20:47:06 | INFO | root | Namespace(a_min=-1000, a_max=1000, b_min=0.0, b_max=1.0, space_x=1.5, space_y=1.5, space_z=2.0, roi_x=96, roi_y=96, roi_z=96, num_workers=8, distributed=False, mode='server', num_samples=6, km_path='./cluster_models_1/cluster_model_1_{}_{}_{}.joblib', n_clusters=480, seed=42, init='k-means++', max_iter=250, batch_size=20, tol=0.0, max_no_improvement=100, n_init=50, reassignment_ratio=0.0)
Dataset 1 LUNA16: number of data: 842
Dataset 2 Covid 19: number of data: 722
Dataset 3 HNSCC: number of data: 1222
Dataset 4 TCIA Colon: number of data: 1535
Dataset 5: number of data: 450
Dataset all training: number of data: 4771
Traceback (most recent call last):
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 140, in <module>
    learn_kmeans(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 71, in learn_kmeans
    feat = load_data(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 50, in load_data
    for idx, batch_data in enumerate(training_loader):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1313, in _next_data
    return self._process_data(data)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 5.
Original Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/dictionary.py", line 131, in __call__
    data = self._loader(d[key], reader)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/array.py", line 240, in __call__
    img_array, meta_data = reader.get_data(img)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/image_reader.py", line 450, in get_data
    data = self._get_array_data(i)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/image_reader.py", line 522, in _get_array_data
    _array = np.array(img.get_fdata(dtype=self.dtype))
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/dataobj_images.py", line 368, in get_fdata
    data = np.asanyarray(self._dataobj, dtype=dtype)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/arrayproxy.py", line 426, in __array__
    arr = self._get_scaled(dtype=dtype, slicer=())
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/arrayproxy.py", line 393, in _get_scaled
    scaled = apply_read_scaling(self._get_unscaled(slicer=slicer), scl_slope, scl_inter)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/arrayproxy.py", line 363, in _get_unscaled
    return array_from_file(
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/volumeutils.py", line 454, in array_from_file
    n_read = infile.readinto(data_bytes)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/gzip.py", line 300, in read
    return self._buffer.read(size)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/_compression.py", line 68, in readinto
    data = self.read(len(byte_view))
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/gzip.py", line 506, in read
    raise EOFError("Compressed file ended before the "
EOFError: Compressed file ended before the end-of-stream marker was reached

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/compose.py", line 173, in __call__
    input_ = apply_transform(_transform, input_, self.map_items, self.unpack_items, self.log_stats)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.io.dictionary.LoadImaged object at 0x149ecea74a00>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 97, in __getitem__
    return self._transform(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 83, in _transform
    return apply_transform(self.transform, data_i) if self.transform is not None else data_i
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.compose.Compose object at 0x149dbac9b670>

2023-04-23 20:49:15 | INFO | root | Namespace(a_min=-1000, a_max=1000, b_min=0.0, b_max=1.0, space_x=1.5, space_y=1.5, space_z=2.0, roi_x=96, roi_y=96, roi_z=96, num_workers=8, distributed=False, mode='server', num_samples=6, km_path='./cluster_models_1/cluster_model_1_{}_{}_{}.joblib', n_clusters=282, seed=42, init='k-means++', max_iter=250, batch_size=20, tol=0.0, max_no_improvement=100, n_init=50, reassignment_ratio=0.0)
Dataset 1 LUNA16: number of data: 842
Dataset 2 Covid 19: number of data: 722
Dataset 3 HNSCC: number of data: 1222
Dataset 4 TCIA Colon: number of data: 1535
Dataset 5: number of data: 450
Dataset all training: number of data: 4771
Traceback (most recent call last):
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 140, in <module>
    learn_kmeans(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 71, in learn_kmeans
    feat = load_data(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 50, in load_data
    for idx, batch_data in enumerate(training_loader):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1313, in _next_data
    return self._process_data(data)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 5.
Original Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/dictionary.py", line 131, in __call__
    data = self._loader(d[key], reader)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/array.py", line 240, in __call__
    img_array, meta_data = reader.get_data(img)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/image_reader.py", line 450, in get_data
    data = self._get_array_data(i)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/image_reader.py", line 522, in _get_array_data
    _array = np.array(img.get_fdata(dtype=self.dtype))
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/dataobj_images.py", line 368, in get_fdata
    data = np.asanyarray(self._dataobj, dtype=dtype)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/arrayproxy.py", line 426, in __array__
    arr = self._get_scaled(dtype=dtype, slicer=())
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/arrayproxy.py", line 393, in _get_scaled
    scaled = apply_read_scaling(self._get_unscaled(slicer=slicer), scl_slope, scl_inter)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/arrayproxy.py", line 363, in _get_unscaled
    return array_from_file(
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/volumeutils.py", line 454, in array_from_file
    n_read = infile.readinto(data_bytes)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/gzip.py", line 300, in read
    return self._buffer.read(size)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/_compression.py", line 68, in readinto
    data = self.read(len(byte_view))
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/gzip.py", line 506, in read
    raise EOFError("Compressed file ended before the "
EOFError: Compressed file ended before the end-of-stream marker was reached

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/compose.py", line 173, in __call__
    input_ = apply_transform(_transform, input_, self.map_items, self.unpack_items, self.log_stats)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.io.dictionary.LoadImaged object at 0x14ddba8c7a00>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 97, in __getitem__
    return self._transform(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 83, in _transform
    return apply_transform(self.transform, data_i) if self.transform is not None else data_i
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.compose.Compose object at 0x14dca6b3f910>

2023-04-23 20:51:23 | INFO | root | Namespace(a_min=-1000, a_max=1000, b_min=0.0, b_max=1.0, space_x=1.5, space_y=1.5, space_z=2.0, roi_x=96, roi_y=96, roi_z=96, num_workers=8, distributed=False, mode='server', num_samples=6, km_path='./cluster_models_1/cluster_model_1_{}_{}_{}.joblib', n_clusters=341, seed=42, init='k-means++', max_iter=250, batch_size=20, tol=0.0, max_no_improvement=100, n_init=50, reassignment_ratio=0.0)
Dataset 1 LUNA16: number of data: 842
Dataset 2 Covid 19: number of data: 722
Dataset 3 HNSCC: number of data: 1222
Dataset 4 TCIA Colon: number of data: 1535
Dataset 5: number of data: 450
Dataset all training: number of data: 4771
Traceback (most recent call last):
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 140, in <module>
    learn_kmeans(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 71, in learn_kmeans
    feat = load_data(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 50, in load_data
    for idx, batch_data in enumerate(training_loader):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1313, in _next_data
    return self._process_data(data)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 5.
Original Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/dictionary.py", line 131, in __call__
    data = self._loader(d[key], reader)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/array.py", line 240, in __call__
    img_array, meta_data = reader.get_data(img)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/image_reader.py", line 450, in get_data
    data = self._get_array_data(i)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/image_reader.py", line 522, in _get_array_data
    _array = np.array(img.get_fdata(dtype=self.dtype))
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/dataobj_images.py", line 368, in get_fdata
    data = np.asanyarray(self._dataobj, dtype=dtype)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/arrayproxy.py", line 426, in __array__
    arr = self._get_scaled(dtype=dtype, slicer=())
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/arrayproxy.py", line 393, in _get_scaled
    scaled = apply_read_scaling(self._get_unscaled(slicer=slicer), scl_slope, scl_inter)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/arrayproxy.py", line 363, in _get_unscaled
    return array_from_file(
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/volumeutils.py", line 454, in array_from_file
    n_read = infile.readinto(data_bytes)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/gzip.py", line 300, in read
    return self._buffer.read(size)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/_compression.py", line 68, in readinto
    data = self.read(len(byte_view))
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/gzip.py", line 506, in read
    raise EOFError("Compressed file ended before the "
EOFError: Compressed file ended before the end-of-stream marker was reached

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/compose.py", line 173, in __call__
    input_ = apply_transform(_transform, input_, self.map_items, self.unpack_items, self.log_stats)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.io.dictionary.LoadImaged object at 0x14bf6ccb1a00>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 97, in __getitem__
    return self._transform(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 83, in _transform
    return apply_transform(self.transform, data_i) if self.transform is not None else data_i
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.compose.Compose object at 0x14be58f29910>

2023-04-23 20:53:30 | INFO | root | Namespace(a_min=-1000, a_max=1000, b_min=0.0, b_max=1.0, space_x=1.5, space_y=1.5, space_z=2.0, roi_x=96, roi_y=96, roi_z=96, num_workers=8, distributed=False, mode='server', num_samples=6, km_path='./cluster_models_1/cluster_model_1_{}_{}_{}.joblib', n_clusters=429, seed=42, init='k-means++', max_iter=250, batch_size=20, tol=0.0, max_no_improvement=100, n_init=50, reassignment_ratio=0.0)
Dataset 1 LUNA16: number of data: 842
Dataset 2 Covid 19: number of data: 722
Dataset 3 HNSCC: number of data: 1222
Dataset 4 TCIA Colon: number of data: 1535
Dataset 5: number of data: 450
Dataset all training: number of data: 4771
Traceback (most recent call last):
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 140, in <module>
    learn_kmeans(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 71, in learn_kmeans
    feat = load_data(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 50, in load_data
    for idx, batch_data in enumerate(training_loader):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1313, in _next_data
    return self._process_data(data)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 5.
Original Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/dictionary.py", line 131, in __call__
    data = self._loader(d[key], reader)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/array.py", line 240, in __call__
    img_array, meta_data = reader.get_data(img)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/image_reader.py", line 450, in get_data
    data = self._get_array_data(i)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/image_reader.py", line 522, in _get_array_data
    _array = np.array(img.get_fdata(dtype=self.dtype))
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/dataobj_images.py", line 368, in get_fdata
    data = np.asanyarray(self._dataobj, dtype=dtype)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/arrayproxy.py", line 426, in __array__
    arr = self._get_scaled(dtype=dtype, slicer=())
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/arrayproxy.py", line 393, in _get_scaled
    scaled = apply_read_scaling(self._get_unscaled(slicer=slicer), scl_slope, scl_inter)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/arrayproxy.py", line 363, in _get_unscaled
    return array_from_file(
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/volumeutils.py", line 454, in array_from_file
    n_read = infile.readinto(data_bytes)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/gzip.py", line 300, in read
    return self._buffer.read(size)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/_compression.py", line 68, in readinto
    data = self.read(len(byte_view))
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/gzip.py", line 506, in read
    raise EOFError("Compressed file ended before the "
EOFError: Compressed file ended before the end-of-stream marker was reached

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/compose.py", line 173, in __call__
    input_ = apply_transform(_transform, input_, self.map_items, self.unpack_items, self.log_stats)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.io.dictionary.LoadImaged object at 0x1528f4873a00>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 97, in __getitem__
    return self._transform(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 83, in _transform
    return apply_transform(self.transform, data_i) if self.transform is not None else data_i
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.compose.Compose object at 0x1527e0a98640>

2023-04-23 20:55:36 | INFO | root | Namespace(a_min=-1000, a_max=1000, b_min=0.0, b_max=1.0, space_x=1.5, space_y=1.5, space_z=2.0, roi_x=96, roi_y=96, roi_z=96, num_workers=8, distributed=False, mode='server', num_samples=6, km_path='./cluster_models_1/cluster_model_1_{}_{}_{}.joblib', n_clusters=464, seed=42, init='k-means++', max_iter=250, batch_size=20, tol=0.0, max_no_improvement=100, n_init=50, reassignment_ratio=0.0)
Dataset 1 LUNA16: number of data: 842
Dataset 2 Covid 19: number of data: 722
Dataset 3 HNSCC: number of data: 1222
Dataset 4 TCIA Colon: number of data: 1535
Dataset 5: number of data: 450
Dataset all training: number of data: 4771
Traceback (most recent call last):
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 140, in <module>
    learn_kmeans(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 71, in learn_kmeans
    feat = load_data(args)
  File "/home/karimimonsefi.1/SSL_VAN/clustering/kmeans_learning.py", line 50, in load_data
    for idx, batch_data in enumerate(training_loader):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1313, in _next_data
    return self._process_data(data)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 5.
Original Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/dictionary.py", line 131, in __call__
    data = self._loader(d[key], reader)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/io/array.py", line 240, in __call__
    img_array, meta_data = reader.get_data(img)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/image_reader.py", line 450, in get_data
    data = self._get_array_data(i)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/image_reader.py", line 522, in _get_array_data
    _array = np.array(img.get_fdata(dtype=self.dtype))
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/dataobj_images.py", line 368, in get_fdata
    data = np.asanyarray(self._dataobj, dtype=dtype)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/arrayproxy.py", line 426, in __array__
    arr = self._get_scaled(dtype=dtype, slicer=())
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/arrayproxy.py", line 393, in _get_scaled
    scaled = apply_read_scaling(self._get_unscaled(slicer=slicer), scl_slope, scl_inter)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/arrayproxy.py", line 363, in _get_unscaled
    return array_from_file(
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/nibabel/volumeutils.py", line 454, in array_from_file
    n_read = infile.readinto(data_bytes)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/gzip.py", line 300, in read
    return self._buffer.read(size)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/_compression.py", line 68, in readinto
    data = self.read(len(byte_view))
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/gzip.py", line 506, in read
    raise EOFError("Compressed file ended before the "
EOFError: Compressed file ended before the end-of-stream marker was reached

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 89, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 53, in _apply_transform
    return transform(parameters)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/compose.py", line 173, in __call__
    input_ = apply_transform(_transform, input_, self.map_items, self.unpack_items, self.log_stats)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.io.dictionary.LoadImaged object at 0x14b3bfb1ba00>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 97, in __getitem__
    return self._transform(index)
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/data/dataset.py", line 83, in _transform
    return apply_transform(self.transform, data_i) if self.transform is not None else data_i
  File "/home/karimimonsefi.1/miniconda3/lib/python3.9/site-packages/monai/transforms/transform.py", line 113, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.compose.Compose object at 0x14b2abd41c40>

2023-04-23 20:57:43 | INFO | root | Namespace(a_min=-1000, a_max=1000, b_min=0.0, b_max=1.0, space_x=1.5, space_y=1.5, space_z=2.0, roi_x=96, roi_y=96, roi_z=96, num_workers=8, distributed=False, mode='server', num_samples=6, km_path='./cluster_models_1/cluster_model_1_{}_{}_{}.joblib', n_clusters=395, seed=42, init='k-means++', max_iter=250, batch_size=20, tol=0.0, max_no_improvement=100, n_init=50, reassignment_ratio=0.0)
Dataset 1 LUNA16: number of data: 842
Dataset 2 Covid 19: number of data: 722
Dataset 3 HNSCC: number of data: 1222
Dataset 4 TCIA Colon: number of data: 1535
Dataset 5: number of data: 450
Dataset all training: number of data: 4771
slurmstepd: error: *** JOB 45968 ON a100-05 CANCELLED AT 2023-04-23T20:58:48 ***
